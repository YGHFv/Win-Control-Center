import{f as re,a as Z}from"../chunks/Di5biFW1.js";import{i as ea}from"../chunks/Bu5AYzux.js";import{o as aa}from"../chunks/DSc4XEBz.js";import{i as he,b as ta,c as pe,h as x,K as ra,a as sa,w as r,av as na,r as ia,H as la,s as Oe,d as ge,k as le,W as oa,ao as va,a6 as ze,e as Q,aK as U,j as Se,l as ua,R as Fe,aG as Y,am as xe,aL as ca,aM as fa,aN as da,aO as _a,f as Ye,p as Ke,aP as me,ai as ha,al as pa,g as ga,V as ma,aQ as wa,aR as ya,aS as Ma,aT as Sa,aU as ba,aV as xa,aI as Pe,q as B,S as Ea,aW as ka,C as Aa,aX as Ta,aY as Na,G as w,D as we,F as Ia,J as b,I as g,aZ as Ue,ax as A,x as Da}from"../chunks/CGmmsghJ.js";import{d as La,s as j,e as Ca,r as Va}from"../chunks/BG-g19ID.js";import{i as Ra}from"../chunks/hk1Sb3z8.js";function Ba(e,a,t){for(var u=[],f=a.length,o,v=a.length,n=0;n<f;n++){let h=a[n];Ke(h,()=>{if(o){if(o.pending.delete(h),o.done.add(h),o.pending.size===0){var y=e.outrogroups;be(xe(o.done)),y.delete(o),y.size===0&&(e.outrogroups=null)}}else v-=1},!1)}if(v===0){var d=u.length===0&&t!==null;if(d){var l=t,_=l.parentNode;pa(_),_.append(l),e.items.clear()}be(a,!d)}else o={pending:new Set(a),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(o)}function be(e,a=!0){for(var t=0;t<e.length;t++)ga(e[t],a)}var qe;function Ha(e,a,t,u,f,o=null){var v=e,n=new Map;{var d=e;v=x?pe(ra(d)):d.appendChild(he())}x&&sa();var l=null,_=na(()=>{var M=t();return ca(M)?M:M==null?[]:xe(M)}),h,y=!0;function N(){I.fallback=l,Oa(I,h,v,a,u),l!==null&&(h.length===0?(l.f&U)===0?Ye(l):(l.f^=U,te(l,null,v)):Ke(l,()=>{l=null}))}var c=ta(()=>{h=r(_);var M=h.length;let D=!1;if(x){var E=ia(v)===la;E!==(M===0)&&(v=Oe(),pe(v),ge(!1),D=!0)}for(var q=new Set,L=Q,H=ua(),C=0;C<M;C+=1){x&&le.nodeType===oa&&le.data===va&&(v=le,D=!0,ge(!1));var G=h[C],O=u(G,C),p=y?null:n.get(O);p?(p.v&&ze(p.v,G),p.i&&ze(p.i,C),H&&L.skipped_effects.delete(p.e)):(p=za(n,y?v:qe??(qe=he()),G,O,C,f,a,t),y||(p.e.f|=U),n.set(O,p)),q.add(O)}if(M===0&&o&&!l&&(y?l=Se(()=>o(v)):(l=Se(()=>o(qe??(qe=he()))),l.f|=U)),x&&M>0&&pe(Oe()),!y)if(H){for(const[W,se]of n)q.has(W)||L.skipped_effects.add(se.e);L.oncommit(N),L.ondiscard(()=>{})}else N();D&&ge(!0),r(_)}),I={effect:c,items:n,outrogroups:null,fallback:l};y=!1,x&&(v=le)}function Oa(e,a,t,u,f){var O;var o=a.length,v=e.items,n=e.effect.first,d,l=null,_=[],h=[],y,N,c,I;for(I=0;I<o;I+=1){if(y=a[I],N=f(y,I),c=v.get(N).e,e.outrogroups!==null)for(const p of e.outrogroups)p.pending.delete(c),p.done.delete(c);if((c.f&U)!==0)if(c.f^=U,c===n)te(c,null,t);else{var M=l?l.next:n;c===e.effect.last&&(e.effect.last=c.prev),c.prev&&(c.prev.next=c.next),c.next&&(c.next.prev=c.prev),F(e,l,c),F(e,c,M),te(c,M,t),l=c,_=[],h=[],n=l.next;continue}if((c.f&me)!==0&&Ye(c),c!==n){if(d!==void 0&&d.has(c)){if(_.length<h.length){var D=h[0],E;l=D.prev;var q=_[0],L=_[_.length-1];for(E=0;E<_.length;E+=1)te(_[E],D,t);for(E=0;E<h.length;E+=1)d.delete(h[E]);F(e,q.prev,L.next),F(e,l,q),F(e,L,D),n=D,l=L,I-=1,_=[],h=[]}else d.delete(c),te(c,n,t),F(e,c.prev,c.next),F(e,c,l===null?e.effect.first:l.next),F(e,l,c),l=c;continue}for(_=[],h=[];n!==null&&n!==c;)(d??(d=new Set)).add(n),h.push(n),n=n.next;if(n===null)continue}(c.f&U)===0&&_.push(c),l=c,n=c.next}if(e.outrogroups!==null){for(const p of e.outrogroups)p.pending.size===0&&(be(xe(p.done)),(O=e.outrogroups)==null||O.delete(p));e.outrogroups.size===0&&(e.outrogroups=null)}if(n!==null||d!==void 0){var H=[];if(d!==void 0)for(c of d)(c.f&me)===0&&H.push(c);for(;n!==null;)(n.f&me)===0&&n!==e.fallback&&H.push(n),n=n.next;var C=H.length;if(C>0){var G=o===0?t:null;Ba(e,H,G)}}}function za(e,a,t,u,f,o,v,n){var d=(v&fa)!==0?(v&da)===0?Y(t,!1,!1):Fe(t):null,l=(v&_a)!==0?Fe(f):null;return{v:d,i:l,e:Se(()=>(o(a,d??t,l??f,n),()=>{e.delete(u)}))}}function te(e,a,t){if(e.nodes)for(var u=e.nodes.start,f=e.nodes.end,o=a&&(a.f&U)===0?a.nodes.start:t;u!==null;){var v=ha(u);if(o.before(u),u===f)return;u=v}}function F(e,a,t){a===null?e.effect.first=t:a.next=t,t===null?e.effect.last=a:t.prev=a}function Fa(e,a,t){var u=e==null?"":""+e;return u=u?u+" "+a:a,u===""?null:u}function Ua(e,a){return e==null?null:String(e)}function qa(e,a,t,u,f,o){var v=e.__className;if(x||v!==t||v===void 0){var n=Fa(t,u);(!x||n!==e.getAttribute("class"))&&(n==null?e.removeAttribute("class"):e.className=n),e.__className=t}return o}function Ga(e,a,t,u){var f=e.__style;if(x||f!==a){var o=Ua(a);(!x||o!==e.getAttribute("style"))&&(o==null?e.removeAttribute("style"):e.style.cssText=o),e.__style=a}return u}const Wa=Symbol("is custom element"),Ya=Symbol("is html");function ee(e){if(x){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var u=e.value;oe(e,"value",null),e.value=u}if(e.hasAttribute("checked")){var f=e.checked;oe(e,"checked",null),e.checked=f}}};e.__on_r=t,ma(t),wa()}}function oe(e,a,t,u){var f=Ka(e);x&&(f[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||f[a]!==(f[a]=t)&&(a==="loading"&&(e[Sa]=t),t==null?e.removeAttribute(a):typeof t!="string"&&Pa(e).includes(a)?e[a]=t:e.setAttribute(a,t))}function Ka(e){return e.__attributes??(e.__attributes={[Wa]:e.nodeName.includes("-"),[Ya]:e.namespaceURI===ya})}var Ge=new Map;function Pa(e){var a=e.getAttribute("is")||e.nodeName,t=Ge.get(a);if(t)return t;Ge.set(a,t=[]);for(var u,f=e,o=Element.prototype;o!==f;){u=ba(f);for(var v in u)u[v].set&&t.push(v);f=Ma(f)}return t}function ae(e,a,t=a){var u=new WeakSet;xa(e,"input",async f=>{var o=f?e.defaultValue:e.value;if(o=ye(e)?Me(o):o,t(o),Q!==null&&u.add(Q),await Pe(),o!==(o=a())){var v=e.selectionStart,n=e.selectionEnd,d=e.value.length;if(e.value=o??"",n!==null){var l=e.value.length;v===n&&n===d&&l>d?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=v,e.selectionEnd=Math.min(n,l))}}}),(x&&e.defaultValue!==e.value||B(a)==null&&e.value)&&(t(ye(e)?Me(e.value):e.value),Q!==null&&u.add(Q)),Ea(()=>{var f=a();if(e===document.activeElement){var o=ka??Q;if(u.has(o))return}ye(e)&&f===Me(e.value)||e.type==="date"&&!f&&!e.value||f!==e.value&&(e.value=f??"")})}function ye(e){var a=e.type;return a==="number"||a==="range"}function Me(e){return e===""?null:+e}async function T(e,a={},t){return window.__TAURI_INTERNALS__.invoke(e,a,t)}function We(e,a="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(e,a)}var Xa=re('<img class="app-icon svelte-1uha8ag" alt=""/>'),$a=re('<div class="app-icon-fallback svelte-1uha8ag"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg></div>'),Ja=re('<div class="app-row svelte-1uha8ag"><div style="cursor: pointer;"><!></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div>'),Qa=re('<div class="loading svelte-1uha8ag">Scanning sessions...</div>'),Za=re('<main class="svelte-1uha8ag"><section class="merged-controls svelte-1uha8ag"><div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="System Volume"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"></path><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Microphone"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="22"></line><line x1="8" y1="22" x2="16" y2="22"></line></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Brightness"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="M4.93 4.93l1.41 1.41"></path><path d="M17.66 17.66l1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="M4.93 19.07l1.41-1.41"></path><path d="M17.66 6.34l1.41-1.41"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Mouse Speed"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="7"></rect><path d="M12 6v4"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="1" max="20" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div></section> <section class="app-section svelte-1uha8ag"><div class="app-list svelte-1uha8ag"></div></section></main>');function nt(e,a){Aa(a,!1);let t=Y(0),u=Y(0),f=Y(100),o=Y(10),v=Y([]),n,d=0,l=!1,_=Y(!1),h=!1;async function y(){await Pe();const i=document.querySelector("main");if(i){const s=i.offsetHeight;try{await T("resize_window",{height:s+2})}catch(m){console.error(m)}}}function N(i,s){let m;return function(...S){clearTimeout(m),m=setTimeout(()=>i.apply(this,S),s)}}const c=N(async i=>{try{await T("set_system_volume",{vol:i/100})}catch(s){console.error(s)}},50),I=N(async i=>{try{await T("set_mic_volume",{vol:i/100})}catch(s){console.error(s)}},50),M=N(async i=>{try{await T("set_brightness",{val:i/100})}catch(s){console.error(s)}},50),D=N(async i=>{try{await T("set_mouse_speed",{val:Math.round(i)})}catch(s){console.error(s)}},100),E=N(async(i,s)=>{try{await T("set_app_volume",{pid:i,vol:s/100})}catch(m){console.error(m)}},50);function q(){d=Date.now(),c(r(t))}function L(){d=Date.now(),I(r(u))}function H(){d=Date.now(),M(r(f))}function C(){d=Date.now(),D(r(o))}function G(i,s){d=Date.now();const m=r(v).find(S=>S.pid===i);m&&(m.volume_display=s,m.volume=s/100,A(v,r(v))),E(i,s)}async function O(i,s){d=Date.now();const m=r(v).find(S=>S.pid===i);m&&(m.is_muted=!s,A(v,r(v)));try{await T("set_app_mute",{pid:i,mute:!s})}catch(S){console.error(S)}}function p(){l=!0,d=Date.now()}function W(){l=!1,d=Date.now()}async function se(){if(!h&&!(r(_)&&Date.now()-d<3e3)){h=!0;try{const i=await Promise.allSettled([T("get_system_volume"),T("get_mic_volume"),T("get_brightness"),T("get_mouse_speed"),T("get_app_volumes")]);if(l)return;const[s,m,S,z,ne]=i;if(s.status==="fulfilled"){const k=s.value*100;(!r(_)||Math.abs(k-r(t))>1)&&A(t,k)}if(m.status==="fulfilled"){const k=m.value*100;(!r(_)||Math.abs(k-r(u))>1)&&A(u,k)}if(S.status==="fulfilled"){const k=S.value*100;(!r(_)||Math.abs(k-r(f))>1)&&A(f,k)}if(z.status==="fulfilled"&&A(o,z.value),ne.status==="fulfilled"){const k=ne.value.map(ie=>({...ie,volume_display:Math.round(ie.volume*100)}));l||A(v,k)}r(_)||(A(_,!0),y())}catch(i){console.error("Load State Error:",i)}finally{h=!1}}}aa(()=>{se(),n=setInterval(()=>{document.visibilityState==="visible"&&se()},2500);const i=()=>{l&&(l=!1)};return window.addEventListener("pointerup",i),window.addEventListener("blur",i),()=>{n&&clearInterval(n),window.removeEventListener("pointerup",i),window.removeEventListener("blur",i)}}),Ta(()=>(r(_),r(v)),()=>{r(_)&&r(v)&&y()}),Na(),ea();var ve=Za(),ue=w(ve),ce=w(ue),Ee=b(w(ce),2),K=w(Ee);ee(K),K.__input=q,K.__pointerdown=p,K.__pointerup=W;var ke=b(K,2),Xe=w(ke,!0);g(ke),g(Ee),g(ce);var fe=b(ce,2),Ae=b(w(fe),2),P=w(Ae);ee(P),P.__input=L,P.__pointerdown=p,P.__pointerup=W;var Te=b(P,2),$e=w(Te,!0);g(Te),g(Ae),g(fe);var de=b(fe,2),Ne=b(w(de),2),X=w(Ne);ee(X),X.__input=H,X.__pointerdown=p,X.__pointerup=W;var Ie=b(X,2),Je=w(Ie,!0);g(Ie),g(Ne),g(de);var De=b(de,2),Le=b(w(De),2),$=w(Le);ee($),$.__input=C,$.__pointerdown=p,$.__pointerup=W;var Ce=b($,2),Qe=w(Ce,!0);g(Ce),g(Le),g(De),g(ue);var Ve=b(ue,2),Re=w(Ve);Ha(Re,5,()=>r(v),i=>i.pid+i.name,(i,s,m)=>{var S=Ja(),z=w(S);z.__click=()=>O(r(s).pid,r(s).is_muted);var ne=w(z);{var k=V=>{var R=Xa();we(_e=>{Ga(R,`filter: ${r(s),B(()=>r(s).is_muted?"grayscale(1) opacity(0.5)":"none")??""}`),oe(R,"src",_e)},[()=>(r(s),Da(We),B(()=>r(s).icon_path.startsWith("data:")?r(s).icon_path:We(r(s).icon_path)))]),Ca("error",R,_e=>{const je=_e.currentTarget;je.style.display="none"}),Va(R),Z(V,R)},ie=V=>{var R=$a();Z(V,R)};Ra(ne,V=>{r(s),B(()=>r(s).icon_path&&r(s).icon_path!=="")?V(k):V(ie,!1)})}g(z);var Be=b(z,2),J=w(Be);ee(J),J.__input=V=>{const R=V.currentTarget.valueAsNumber;r(s).volume=R/100,Ue(()=>r(v)),G(r(s).pid,R)},J.__pointerdown=p,J.__pointerup=W;var He=b(J,2),Ze=w(He,!0);g(He),g(Be),g(S),we(()=>{qa(z,1,`icon-box ${r(s),B(()=>r(s).is_muted?"muted":"")??""}`,"svelte-1uha8ag"),oe(z,"title",(r(s),B(()=>r(s).name))),j(Ze,(r(s),B(()=>r(s).volume_display)))}),ae(J,()=>r(s).volume_display,V=>(r(s).volume_display=V,Ue(()=>r(v)))),Z(i,S)},i=>{var s=Qa();Z(i,s)}),g(Re),g(Ve),g(ve),we((i,s,m)=>{j(Xe,i),j($e,s),j(Je,m),j(Qe,r(o))},[()=>(r(t),B(()=>Math.round(r(t)))),()=>(r(u),B(()=>Math.round(r(u)))),()=>(r(f),B(()=>Math.round(r(f))))]),ae(K,()=>r(t),i=>A(t,i)),ae(P,()=>r(u),i=>A(u,i)),ae(X,()=>r(f),i=>A(f,i)),ae($,()=>r(o),i=>A(o,i)),Z(e,ve),Ia()}La(["input","pointerdown","pointerup","click"]);export{nt as component};
