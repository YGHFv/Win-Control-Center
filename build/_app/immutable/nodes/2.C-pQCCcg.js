import{f as oe,a as ne}from"../chunks/Di5biFW1.js";import{i as aa}from"../chunks/Bu5AYzux.js";import{o as ta}from"../chunks/DSc4XEBz.js";import{i as pe,b as ra,c as ge,h as E,K as sa,a as na,w as r,av as ia,r as la,H as oa,s as ze,d as me,k as ie,W as va,ao as ua,a6 as Fe,e as Q,aK as F,j as be,l as ca,R as Ue,aG as W,am as Me,aL as fa,aM as da,aN as _a,aO as ha,f as Ke,p as Pe,aP as we,ai as pa,al as ga,g as ma,V as wa,aQ as ya,aR as xa,aS as Sa,aT as ba,aU as Ea,aV as Ma,aI as Xe,q as D,S as ka,aW as Aa,C as Ta,aX as Na,aY as Ia,G as w,D as ye,F as Da,J as x,I as g,aZ as $e,ax as A,x as La}from"../chunks/CGmmsghJ.js";import{d as Ca,s as j,e as Va,r as Ra}from"../chunks/BG-g19ID.js";import{i as Ba}from"../chunks/hk1Sb3z8.js";function Ha(e,a,t){for(var u=[],f=a.length,o,v=a.length,n=0;n<f;n++){let h=a[n];Pe(h,()=>{if(o){if(o.pending.delete(h),o.done.add(h),o.pending.size===0){var y=e.outrogroups;Ee(Me(o.done)),y.delete(o),y.size===0&&(e.outrogroups=null)}}else v-=1},!1)}if(v===0){var d=u.length===0&&t!==null;if(d){var l=t,_=l.parentNode;ga(_),_.append(l),e.items.clear()}Ee(a,!d)}else o={pending:new Set(a),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(o)}function Ee(e,a=!0){for(var t=0;t<e.length;t++)ma(e[t],a)}var qe;function Oa(e,a,t,u,f,o=null){var v=e,n=new Map;{var d=e;v=E?ge(sa(d)):d.appendChild(pe())}E&&na();var l=null,_=ia(()=>{var S=t();return fa(S)?S:S==null?[]:Me(S)}),h,y=!0;function N(){I.fallback=l,za(I,h,v,a,u),l!==null&&(h.length===0?(l.f&F)===0?Ke(l):(l.f^=F,te(l,null,v)):Pe(l,()=>{l=null}))}var c=ra(()=>{h=r(_);var S=h.length;let L=!1;if(E){var M=la(v)===oa;M!==(S===0)&&(v=ze(),ge(v),me(!1),L=!0)}for(var U=new Set,C=Q,R=ca(),V=0;V<S;V+=1){E&&ie.nodeType===va&&ie.data===ua&&(v=ie,L=!0,me(!1));var $=h[V],B=u($,V),p=y?null:n.get(B);p?(p.v&&Fe(p.v,$),p.i&&Fe(p.i,V),R&&C.skipped_effects.delete(p.e)):(p=Fa(n,y?v:qe??(qe=pe()),$,B,V,f,a,t),y||(p.e.f|=F),n.set(B,p)),U.add(B)}if(S===0&&o&&!l&&(y?l=be(()=>o(v)):(l=be(()=>o(qe??(qe=pe()))),l.f|=F)),E&&S>0&&ge(ze()),!y)if(R){for(const[q,re]of n)U.has(q)||C.skipped_effects.add(re.e);C.oncommit(N),C.ondiscard(()=>{})}else N();L&&me(!0),r(_)}),I={effect:c,items:n,outrogroups:null,fallback:l};y=!1,E&&(v=ie)}function za(e,a,t,u,f){var B;var o=a.length,v=e.items,n=e.effect.first,d,l=null,_=[],h=[],y,N,c,I;for(I=0;I<o;I+=1){if(y=a[I],N=f(y,I),c=v.get(N).e,e.outrogroups!==null)for(const p of e.outrogroups)p.pending.delete(c),p.done.delete(c);if((c.f&F)!==0)if(c.f^=F,c===n)te(c,null,t);else{var S=l?l.next:n;c===e.effect.last&&(e.effect.last=c.prev),c.prev&&(c.prev.next=c.next),c.next&&(c.next.prev=c.prev),z(e,l,c),z(e,c,S),te(c,S,t),l=c,_=[],h=[],n=l.next;continue}if((c.f&we)!==0&&Ke(c),c!==n){if(d!==void 0&&d.has(c)){if(_.length<h.length){var L=h[0],M;l=L.prev;var U=_[0],C=_[_.length-1];for(M=0;M<_.length;M+=1)te(_[M],L,t);for(M=0;M<h.length;M+=1)d.delete(h[M]);z(e,U.prev,C.next),z(e,l,U),z(e,C,L),n=L,l=C,I-=1,_=[],h=[]}else d.delete(c),te(c,n,t),z(e,c.prev,c.next),z(e,c,l===null?e.effect.first:l.next),z(e,l,c),l=c;continue}for(_=[],h=[];n!==null&&n!==c;)(d??(d=new Set)).add(n),h.push(n),n=n.next;if(n===null)continue}(c.f&F)===0&&_.push(c),l=c,n=c.next}if(e.outrogroups!==null){for(const p of e.outrogroups)p.pending.size===0&&(Ee(Me(p.done)),(B=e.outrogroups)==null||B.delete(p));e.outrogroups.size===0&&(e.outrogroups=null)}if(n!==null||d!==void 0){var R=[];if(d!==void 0)for(c of d)(c.f&we)===0&&R.push(c);for(;n!==null;)(n.f&we)===0&&n!==e.fallback&&R.push(n),n=n.next;var V=R.length;if(V>0){var $=o===0?t:null;Ha(e,R,$)}}}function Fa(e,a,t,u,f,o,v,n){var d=(v&da)!==0?(v&_a)===0?W(t,!1,!1):Ue(t):null,l=(v&ha)!==0?Ue(f):null;return{v:d,i:l,e:be(()=>(o(a,d??t,l??f,n),()=>{e.delete(u)}))}}function te(e,a,t){if(e.nodes)for(var u=e.nodes.start,f=e.nodes.end,o=a&&(a.f&F)===0?a.nodes.start:t;u!==null;){var v=pa(u);if(o.before(u),u===f)return;u=v}}function z(e,a,t){a===null?e.effect.first=t:a.next=t,t===null?e.effect.last=a:t.prev=a}function Ua(e,a,t){var u=e==null?"":""+e;return u=u?u+" "+a:a,u===""?null:u}function $a(e,a){return e==null?null:String(e)}function qa(e,a,t,u,f,o){var v=e.__className;if(E||v!==t||v===void 0){var n=Ua(t,u);(!E||n!==e.getAttribute("class"))&&(n==null?e.removeAttribute("class"):e.className=n),e.__className=t}return o}function Ge(e,a,t,u){var f=e.__style;if(E||f!==a){var o=$a(a);(!E||o!==e.getAttribute("style"))&&(o==null?e.removeAttribute("style"):e.style.cssText=o),e.__style=a}return u}const Ga=Symbol("is custom element"),Wa=Symbol("is html");function ee(e){if(E){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var u=e.value;le(e,"value",null),e.value=u}if(e.hasAttribute("checked")){var f=e.checked;le(e,"checked",null),e.checked=f}}};e.__on_r=t,wa(t),ya()}}function le(e,a,t,u){var f=Ya(e);E&&(f[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||f[a]!==(f[a]=t)&&(a==="loading"&&(e[ba]=t),t==null?e.removeAttribute(a):typeof t!="string"&&Ka(e).includes(a)?e[a]=t:e.setAttribute(a,t))}function Ya(e){return e.__attributes??(e.__attributes={[Ga]:e.nodeName.includes("-"),[Wa]:e.namespaceURI===xa})}var We=new Map;function Ka(e){var a=e.getAttribute("is")||e.nodeName,t=We.get(a);if(t)return t;We.set(a,t=[]);for(var u,f=e,o=Element.prototype;o!==f;){u=Ea(f);for(var v in u)u[v].set&&t.push(v);f=Sa(f)}return t}function ae(e,a,t=a){var u=new WeakSet;Ma(e,"input",async f=>{var o=f?e.defaultValue:e.value;if(o=xe(e)?Se(o):o,t(o),Q!==null&&u.add(Q),await Xe(),o!==(o=a())){var v=e.selectionStart,n=e.selectionEnd,d=e.value.length;if(e.value=o??"",n!==null){var l=e.value.length;v===n&&n===d&&l>d?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=v,e.selectionEnd=Math.min(n,l))}}}),(E&&e.defaultValue!==e.value||D(a)==null&&e.value)&&(t(xe(e)?Se(e.value):e.value),Q!==null&&u.add(Q)),ka(()=>{var f=a();if(e===document.activeElement){var o=Aa??Q;if(u.has(o))return}xe(e)&&f===Se(e.value)||e.type==="date"&&!f&&!e.value||f!==e.value&&(e.value=f??"")})}function xe(e){var a=e.type;return a==="number"||a==="range"}function Se(e){return e===""?null:+e}async function T(e,a={},t){return window.__TAURI_INTERNALS__.invoke(e,a,t)}function Ye(e,a="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(e,a)}var Pa=oe('<img class="app-icon svelte-1uha8ag" alt=""/>'),Xa=oe('<div class="app-row svelte-1uha8ag"><div style="cursor: pointer;"><!> <div class="app-icon-fallback svelte-1uha8ag"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg></div></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div>'),Ja=oe('<div class="loading svelte-1uha8ag">Scanning sessions...</div>'),Qa=oe('<main class="svelte-1uha8ag"><section class="merged-controls svelte-1uha8ag"><div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="System Volume"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"></path><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Microphone"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="22"></line><line x1="8" y1="22" x2="16" y2="22"></line></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Brightness"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="M4.93 4.93l1.41 1.41"></path><path d="M17.66 17.66l1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="M4.93 19.07l1.41-1.41"></path><path d="M17.66 6.34l1.41-1.41"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Mouse Speed"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="7"></rect><path d="M12 6v4"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="1" max="20" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div></section> <section class="app-section svelte-1uha8ag"><div class="app-list svelte-1uha8ag"></div></section></main>');function st(e,a){Ta(a,!1);let t=W(0),u=W(0),f=W(100),o=W(10),v=W([]),n,d=0,l=!1,_=W(!1),h=!1;async function y(){await Xe();const i=document.querySelector("main");if(i){const s=i.offsetHeight;try{await T("resize_window",{height:s+2})}catch(m){console.error(m)}}}function N(i,s){let m;return function(...b){clearTimeout(m),m=setTimeout(()=>i.apply(this,b),s)}}const c=N(async i=>{try{await T("set_system_volume",{vol:i/100})}catch(s){console.error(s)}},50),I=N(async i=>{try{await T("set_mic_volume",{vol:i/100})}catch(s){console.error(s)}},50),S=N(async i=>{try{await T("set_brightness",{val:i/100})}catch(s){console.error(s)}},50),L=N(async i=>{try{await T("set_mouse_speed",{val:Math.round(i)})}catch(s){console.error(s)}},100),M=N(async(i,s)=>{try{await T("set_app_volume",{pid:i,vol:s/100})}catch(m){console.error(m)}},50);function U(){d=Date.now(),c(r(t))}function C(){d=Date.now(),I(r(u))}function R(){d=Date.now(),S(r(f))}function V(){d=Date.now(),L(r(o))}function $(i,s){d=Date.now();const m=r(v).find(b=>b.pid===i);m&&(m.volume_display=s,m.volume=s/100,A(v,r(v))),M(i,s)}async function B(i,s){d=Date.now();const m=r(v).find(b=>b.pid===i);m&&(m.is_muted=!s,A(v,r(v)));try{await T("set_app_mute",{pid:i,mute:!s})}catch(b){console.error(b)}}function p(){l=!0,d=Date.now()}function q(){l=!1,d=Date.now()}async function re(){if(!h&&!(r(_)&&Date.now()-d<3e3)){h=!0;try{const i=await Promise.allSettled([T("get_system_volume"),T("get_mic_volume"),T("get_brightness"),T("get_mouse_speed"),T("get_app_volumes")]);if(l)return;const[s,m,b,H,Z]=i;if(s.status==="fulfilled"){const k=s.value*100;(!r(_)||Math.abs(k-r(t))>1)&&A(t,k)}if(m.status==="fulfilled"){const k=m.value*100;(!r(_)||Math.abs(k-r(u))>1)&&A(u,k)}if(b.status==="fulfilled"){const k=b.value*100;(!r(_)||Math.abs(k-r(f))>1)&&A(f,k)}if(H.status==="fulfilled"&&A(o,H.value),Z.status==="fulfilled"){const k=Z.value.map(se=>({...se,volume_display:Math.round(se.volume*100)}));l||A(v,k)}r(_)||(A(_,!0),y())}catch(i){console.error("Load State Error:",i)}finally{h=!1}}}ta(()=>{re(),n=setInterval(()=>{document.visibilityState==="visible"&&re()},2500);const i=()=>{l&&(l=!1)};return window.addEventListener("pointerup",i),window.addEventListener("blur",i),()=>{n&&clearInterval(n),window.removeEventListener("pointerup",i),window.removeEventListener("blur",i)}}),Na(()=>(r(_),r(v)),()=>{r(_)&&r(v)&&y()}),Ia(),aa();var ve=Qa(),ue=w(ve),ce=w(ue),ke=x(w(ce),2),Y=w(ke);ee(Y),Y.__input=U,Y.__pointerdown=p,Y.__pointerup=q;var Ae=x(Y,2),Je=w(Ae,!0);g(Ae),g(ke),g(ce);var fe=x(ce,2),Te=x(w(fe),2),K=w(Te);ee(K),K.__input=C,K.__pointerdown=p,K.__pointerup=q;var Ne=x(K,2),Qe=w(Ne,!0);g(Ne),g(Te),g(fe);var de=x(fe,2),Ie=x(w(de),2),P=w(Ie);ee(P),P.__input=R,P.__pointerdown=p,P.__pointerup=q;var De=x(P,2),Ze=w(De,!0);g(De),g(Ie),g(de);var Le=x(de,2),Ce=x(w(Le),2),X=w(Ce);ee(X),X.__input=V,X.__pointerdown=p,X.__pointerup=q;var Ve=x(X,2),je=w(Ve,!0);g(Ve),g(Ce),g(Le),g(ue);var Re=x(ue,2),Be=w(Re);Oa(Be,5,()=>r(v),i=>i.pid+i.name,(i,s,m)=>{var b=Xa(),H=w(b);H.__click=()=>B(r(s).pid,r(s).is_muted);var Z=w(H);{var k=G=>{var O=Pa();ye(_e=>{Ge(O,`filter: ${r(s),D(()=>r(s).is_muted?"grayscale(1) opacity(0.5)":"none")??""}`),le(O,"src",_e)},[()=>(r(s),La(Ye),D(()=>r(s).icon_path.startsWith("data:")?r(s).icon_path:Ye(r(s).icon_path)))]),Va("error",O,_e=>{const he=_e.currentTarget;he.style.display="none",he.nextElementSibling&&(he.nextElementSibling.style.display="flex")}),Ra(O),ne(G,O)};Ba(Z,G=>{r(s),D(()=>r(s).icon_path)&&G(k)})}var se=x(Z,2);g(H);var He=x(H,2),J=w(He);ee(J),J.__input=G=>{const O=G.currentTarget.valueAsNumber;r(s).volume=O/100,$e(()=>r(v)),$(r(s).pid,O)},J.__pointerdown=p,J.__pointerup=q;var Oe=x(J,2),ea=w(Oe,!0);g(Oe),g(He),g(b),ye(()=>{qa(H,1,`icon-box ${r(s),D(()=>r(s).is_muted?"muted":"")??""}`,"svelte-1uha8ag"),le(H,"title",(r(s),D(()=>r(s).name))),Ge(se,`display: ${r(s),D(()=>!r(s).icon_path||r(s).icon_path===""?"flex":"none")??""}`),j(ea,(r(s),D(()=>r(s).volume_display)))}),ae(J,()=>r(s).volume_display,G=>(r(s).volume_display=G,$e(()=>r(v)))),ne(i,b)},i=>{var s=Ja();ne(i,s)}),g(Be),g(Re),g(ve),ye((i,s,m)=>{j(Je,i),j(Qe,s),j(Ze,m),j(je,r(o))},[()=>(r(t),D(()=>Math.round(r(t)))),()=>(r(u),D(()=>Math.round(r(u)))),()=>(r(f),D(()=>Math.round(r(f))))]),ae(Y,()=>r(t),i=>A(t,i)),ae(K,()=>r(u),i=>A(u,i)),ae(P,()=>r(f),i=>A(f,i)),ae(X,()=>r(o),i=>A(o,i)),ne(e,ve),Da()}Ca(["input","pointerdown","pointerup","click"]);export{st as component};
